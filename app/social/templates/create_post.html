{% extends 'base.html' %}
{% load custom_filters %}
{% block content %}
<div class="container mt-4">
    <div class="card shadow-sm p-4">
        <h2 class="text-center mb-4">Create Post</h2>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="mb-3">
                <label for="title" class="form-label">Title:</label>
                <input type="text" name="title" id="title" class="form-control" placeholder="Enter a title">
            </div>

            <div class="mb-3">
                <label for="content_type" class="form-label">Content Type:</label>
                <select name="content_type" id="content_type" class="form-select" onchange="toggleContentInput()">
                    <option value="text/plain">Plain Text</option>
                    <option value="text/markdown">Markdown</option>
                    <option value="image/png;base64">PNG Image</option>
                    <option value="image/jpeg;base64">JPEG Image</option>
                    <option value="application/base64">Base64 Image</option>
                    <option value="video/mp4">MP4 Video</option>
                    <option value="video/avi">AVI Video</option>
                    <option value="video/mov">MOV Video</option>
                </select>
            </div>
            
            <!-- Text Content -->
            <div class="mb-3" id="textContent">
                <label for="content" class="form-label">Content:</label>
                <textarea name="content" id="content" rows="4" class="form-control" placeholder="What's on your mind?"></textarea>
            </div>

            <div id="videoUpload" class="mb-3 d-none">
                <label for="video">Upload Video (Max 4s):</label>
                <input type="file" name="video" id="video" accept="video/*">
            </div>            

            <!-- Image Upload -->
            <div class="mb-3 d-none" id="imageUpload">
                <label for="image" class="form-label">Upload Image:</label>
                <input type="file" name="image" id="image" class="form-control">
            </div>

            <div class="mb-3">
                <label for="visibility" class="form-label">Visibility:</label>
                <select name="visibility" id="visibility" class="form-select">
                    <option value="PUBLIC">Public</option>
                    <option value="FRIENDS">Friends Only</option>
                    <option value="UNLISTED">Unlisted</option>
                </select>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary px-4">Post</button>
            </div>
        </form>
    </div>
</div>

<script>
    function toggleContentInput() {
        let contentType = document.getElementById("content_type").value;
        let textContent = document.getElementById("textContent");
        let imageUpload = document.getElementById("imageUpload");
        let videoUpload = document.getElementById("videoUpload");
        let imageInput = document.getElementById("image");
        let videoInput = document.getElementById("video");
        let textInput = document.getElementById("content");

        if (contentType.includes("image") || contentType === "application/base64") {
            // Show image upload, hide text & video
            textContent.classList.add("d-none");
            videoUpload.classList.add("d-none");
            imageUpload.classList.remove("d-none");

            // Clear other input fields
            textInput.value = "";
            videoInput.value = "";
        } else if (contentType.includes("video")) {
            // Show video upload, hide text & image
            textContent.classList.add("d-none");
            imageUpload.classList.add("d-none");
            videoUpload.classList.remove("d-none");

            // Clear other input fields
            textInput.value = "";
            imageInput.value = "";
        } else {
            // Show text area, hide image & video uploads
            textContent.classList.remove("d-none");
            imageUpload.classList.add("d-none");
            videoUpload.classList.add("d-none");

            // Clear other input fields
            imageInput.value = "";
            videoInput.value = "";
        }
    }
</script>


{% endblock %}
